#!env perl6
use lib "lib";
use Red;

multi MAIN("generate-code", Str :$schema-class, Str :$driver, *%pars) {

    my $*RED-DB = database($driver, |%pars);

    my $class = $*RED-DB.schema-viewer-class-name;

    require ::($class);

    my Bool $no-use = False;
    for ::($class).tables-names {
        say "use Red;\n" unless $no-use;
        say "#| Table: $_";
        say ::($class)
            .table-definition($_)
            .to-code:
                |(:$schema-class with $schema-class)
        ;
        $no-use++ with $schema-class
    }
}
